{
  "kind": "build_request",
  "title": "Add size-based pricing to product variant system",
  "projectName": "Mosslight Studios",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-76",
      "text": "Update the backend Variant data type in main.mo to include a price field (Nat) alongside the existing size, color, and inventory fields",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Variant type includes a price: Nat field",
        "Existing variant creation methods accept price parameter",
        "Price is stored with each size/color combination"
      ]
    },
    {
      "id": "REQ-77",
      "text": "Update the VariantManager component to include a price input field for each variant, allowing admins to set individual prices when adding or editing size/color combinations",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Each variant row in the table displays a price input field",
        "Price values are validated as positive numbers",
        "New variants include price when added",
        "Edited variants can update price values"
      ]
    },
    {
      "id": "REQ-78",
      "text": "Update ProductDetailPage to display the selected variant's price dynamically when the size selection changes, replacing the base product price display",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Price updates immediately when size selector changes",
        "Selected variant price displays in the product price area",
        "Price formatting matches existing currency format",
        "Falls back to base product price if no variant is selected"
      ]
    },
    {
      "id": "REQ-79",
      "text": "Update the addToCart functionality in useCart hook and backend to use the selected variant's price instead of the base product price when adding items with variants to the cart",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Cart items store the variant price at time of addition",
        "Cart calculations use variant price for line item totals",
        "Checkout uses variant price for order total calculation"
      ]
    },
    {
      "id": "REQ-80",
      "text": "Update CartPage to display the variant-specific price for each cart item that includes product variants",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Cart line items show the price of the selected variant",
        "Line item subtotals calculate correctly with variant price",
        "Cart total reflects all variant prices accurately"
      ]
    },
    {
      "id": "REQ-81",
      "text": "Update MyOrderCard component to display the variant-specific price that was paid for each order line item with product variants in the order history",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-final"
        ],
        "quotes": [
          "a small hoodie could be $ 6  where a 5x could be $14"
        ]
      },
      "acceptanceCriteria": [
        "Order history shows the exact variant price paid at purchase time",
        "Order line items display size, color, and price together",
        "Order total calculations match the sum of variant prices"
      ]
    },
    {
      "id": "REQ-82",
      "text": "Create a migration.mo module to transform existing variant data structures from the current schema (without price field) to the new schema (with price field) by adding a default price field to existing variants",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-final"
        ]
      },
      "acceptanceCriteria": [
        "Migration adds price field to existing variants without losing data",
        "Default price value is set for variants that lack pricing",
        "Migration preserves size, color, and inventory data"
      ]
    }
  ],
  "constraints": [
    "Maintain single-actor backend architecture in main.mo",
    "Do not modify immutable frontend paths: useInternetIdentity.ts, useInternetIdentity.tsx, useActor.ts, main.tsx, components/ui",
    "Colors remain aesthetic choices without price impact",
    "Preserve existing variant system with size/color combinations and individual inventory"
  ],
  "nonGoals": [
    "Color-based pricing variations",
    "Dynamic pricing rules or algorithms",
    "Bulk pricing or quantity discounts",
    "Currency conversion or multi-currency support",
    "Price history or price change tracking"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}